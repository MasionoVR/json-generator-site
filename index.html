<!DOCTYPE html>
<html>
<head>
  <title>Masiono's 444 Json Converter</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: Arial, sans-serif;
      background: url('R.jpg') no-repeat center center fixed;
      background-size: cover;
      color: white;
      padding: 20px;
      display: flex;
      flex-direction: row;
      gap: 20px;
    }
    .container {
      max-width: 600px;
      background: rgba(30, 30, 30, 0.9);
      padding: 20px;
      border-radius: 10px;
      flex: 1;
    }
    .preview {
      width: 450px;
      max-height: 90vh;
      overflow-y: auto;
      background: rgba(0,0,0,0.6);
      padding: 15px;
      border-radius: 12px;
    }
    label, input, select, button {
      width: 100%;
      margin-top: 10px;
      padding: 10px;
      border-radius: 5px;
    }
    .scrollbox {
      max-height: 300px;
      overflow-y: auto;
      border: 1px solid #444;
      padding: 10px;
      background: #1a1a1a;
      border-radius: 5px;
    }
    .tab {
      background: #222;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 8px;
    }
    .tab h4 {
      margin-top: 0;
      font-size: 18px;
    }
    .tab .colorPreview {
      height: 35px;
      border-radius: 5px;
      background: gray;
      margin-top: 8px;
    }
    #searchInput {
      width: 80%;
      margin: 10px auto;
      display: block;
      font-size: 18px;
    }
    .download-button {
      font-size: 16px;
      padding: 12px;
      font-weight: bold;
      width: 48%;
    }
  </style>
</head>
<body>
<div class="container">
  <h2>Masiono's 444 Json Converter</h2>

  <input type="text" id="searchInput" placeholder="Search items..." onkeyup="filterItems()">
  <button onclick="selectAllItems()">Select All Items</button>
  <button onclick="deselectAllItems()">Deselect All Items</button>

  <label>Backpacks: <span id="backpackCountVal">1</span></label>
  <input type="range" id="backpackCount" min="1" max="28" value="1" oninput="updateSlider('backpackCount')">

  <label>Rayguns per Backpack: <span id="raygunCountVal">1</span></label>
  <input type="range" id="raygunCount" min="1" max="28" value="1" oninput="updateSlider('raygunCount')">

  <label>Select Items:</label>
  <div class="scrollbox" id="itemList">
<label><input type="checkbox" value="item_apple"> Apple</label>
<label><input type="checkbox" value="item_company_ration"> Company Ration</label>
<label><input type="checkbox" value="item_company_ration_heal"> Company Ration Heal</label>
<label><input type="checkbox" value="item_cracker"> Cracker</label>
<label><input type="checkbox" value="item_heart_chocolate_box"> Heart Chocolate Box</label>
<label><input type="checkbox" value="item_mega_broccoli"> Mega Broccoli</label>
<label><input type="checkbox" value="item_micro_broccoli"> Micro Broccoli</label>
<label><input type="checkbox" value="item_pumpkin_pie"> Pumpkin Pie</label>
<label><input type="checkbox" value="item_stinky_cheese"> Stinky Cheese</label>
<label><input type="checkbox" value="item_turkey_leg"> Turkey Leg</label>
<label><input type="checkbox" value="item_turkey_whole"> Turkey Whole</label>
<label><input type="checkbox" value="item_banana"> Banana</label>
<label><input type="checkbox" value="item_large_banana"> Large Banana</label>
<label><input type="checkbox" value="item_cola"> Cola</label>
<label><input type="checkbox" value="item_large_cola"> Large Cola</label>
<label><input type="checkbox" value="item_pizza"> Pizza</label>
<label><input type="checkbox" value="item_backpack"> Backpack</label>
<label><input type="checkbox" value="item_large_backpack"> Large Backpack</label>
<label><input type="checkbox" value="item_large_basketball_print_backpack"> Large Basketball Print Backpack</label>
<label><input type="checkbox" value="item_large_clover_print_backpack"> Large Clover Print Backpack</label>
<label><input type="checkbox" value="item_small_backpack"> Small Backpack</label>
<label><input type="checkbox" value="item_quiver"> Quiver</label>
<label><input type="checkbox" value="item_heart_quiver"> Heart Quiver</label>
<label><input type="checkbox" value="item_nut_shredder"> Nut Shredder</label>
<label><input type="checkbox" value="item_black_backpack"> Black Backpack</label>
<label><input type="checkbox" value="item_green_backpack"> Green Backpack</label>
<label><input type="checkbox" value="item_pink_backpack"> Pink Backpack</label>
<label><input type="checkbox" value="item_white_backpack"> White Backpack</label>
<label><input type="checkbox" value="item_backpack_with_flashlight"> Backpack with Flashlight</label>
<label><input type="checkbox" value="item_baseball_bat"> Baseball Bat</label>
<label><input type="checkbox" value="item_crossbow"> Crossbow</label>
<label><input type="checkbox" value="item_heart_crossbow"> Heart Crossbow</label>
<label><input type="checkbox" value="item_crowbar"> Crowbar</label>
<label><input type="checkbox" value="item_flaregun"> Flaregun</label>
<label><input type="checkbox" value="item_frying_pan"> Frying Pan</label>
<label><input type="checkbox" value="item_heart_gun"> Heart Gun</label>
<label><input type="checkbox" value="item_lance"> Lance</label>
<label><input type="checkbox" value="item_ogre_hands"> Ogre Hands</label>
<label><input type="checkbox" value="item_pickaxe"> Pickaxe</label>
<label><input type="checkbox" value="item_golded_pickaxe"> Golded Pickaxe</label>
<label><input type="checkbox" value="item_cube_pickaxe"> Cube Pickaxe</label>
<label><input type="checkbox" value="item_police_baton_crowbar"> Police Baton (Crowbar)</label>
<label><input type="checkbox" value="item_revolver"> Revolver</label>
<label><input type="checkbox" value="item_rpg"> RPG</label>
<label><input type="checkbox" value="item_rocket_dragon_rpg"> Rocket Dragon RPG</label>
<label><input type="checkbox" value="item_easter_rpg"> Easter RPG</label>
<label><input type="checkbox" value="item_shield"> Shield</label>
<label><input type="checkbox" value="item_protective_bone_shield"> Protective Bone Shield</label>
<label><input type="checkbox" value="item_police_shield"> Police Shield</label>
<label><input type="checkbox" value="item_shotgun"> Shotgun</label>
<label><input type="checkbox" value="item_snowball"> Snowball</label>
<label><input type="checkbox" value="item_arm_bones_stick"> Arm Bones (Stick)</label>
<label><input type="checkbox" value="item_bone_stick"> Bone (Stick)</label>
<label><input type="checkbox" value="item_tree_stick"> Tree Stick</label>
<label><input type="checkbox" value="item_arrow"> Arrow</label>
<label><input type="checkbox" value="item_heart_arrow"> Heart Arrow</label>
<label><input type="checkbox" value="item_lightbulb_arrow"> Lightbulb Arrow</label>
<label><input type="checkbox" value="item_revolver_ammo"> Revolver Ammo</label>
<label><input type="checkbox" value="item_rpg_rocket"> RPG Rocket</label>
<label><input type="checkbox" value="item_shotgun_ammo"> Shotgun Ammo</label>
<label><input type="checkbox" value="item_rope"> Rope</label>
<label><input type="checkbox" value="item_boombox"> Boombox</label>
<label><input type="checkbox" value="item_box_fan"> Box Fan</label>
<label><input type="checkbox" value="item_disposable_camera"> Disposable Camera</label>
<label><input type="checkbox" value="item_flashlight"> Flashlight</label>
<label><input type="checkbox" value="item_mega_flashlight"> Mega Flashlight</label>
<label><input type="checkbox" value="item_glowstick"> Glowstick</label>
<label><input type="checkbox" value="item_hookshot"> Hookshot</label>
<label><input type="checkbox" value="item_hoverpad"> Hoverpad</label>
<label><input type="checkbox" value="item_jetpack"> Jetpack</label>
<label><input type="checkbox" value="item_plunger"> Plunger</label>
<label><input type="checkbox" value="item_saddle"> Saddle</label>
<label><input type="checkbox" value="item_sticker_dispenser"> Sticker Dispenser</label>
<label><input type="checkbox" value="item_tablet"> Tablet</label>
<label><input type="checkbox" value="item_tele_grenade"> Tele Grenade</label>
<label><input type="checkbox" value="item_umbrella"> Umbrella</label>
<label><input type="checkbox" value="item_clover_umbrella"> Clover Umbrella</label>
<label><input type="checkbox" value="item_zipline_gun"> Zipline Gun</label>
<label><input type="checkbox" value="item_balloon"> Balloon</label>
<label><input type="checkbox" value="item_heart_balloon"> Heart Balloon</label>
<label><input type="checkbox" value="item_clapper"> Clapper</label>
<label><input type="checkbox" value="item_football"> Football</label>
<label><input type="checkbox" value="item_pogostick"> Pogostick</label>
<label><input type="checkbox" value="item_rubber_ducky"> Rubber Ducky</label>
<label><input type="checkbox" value="item_theremin"> Theremin</label>
<label><input type="checkbox" value="item_whoopie"> Whoopie</label>
<label><input type="checkbox" value="item_cluster_grenade"> Cluster Grenade</label>
<label><input type="checkbox" value="item_dynamite"> Dynamite</label>
<label><input type="checkbox" value="item_cube_dynamite"> Cube Dynamite</label>
<label><input type="checkbox" value="item_flashbang"> Flashbang</label>
<label><input type="checkbox" value="item_impact_grenade"> Impact Grenade</label>
<label><input type="checkbox" value="item_impulse_grenade"> Impulse Grenade</label>
<label><input type="checkbox" value="item_sticky_dynamite"> Sticky Dynamite</label>
<label><input type="checkbox" value="item_tripwire_explosive"> Tripwire Explosive</label>
<label><input type="checkbox" value="item_cardboard_box"> Cardboard Box</label>
<label><input type="checkbox" value="item_cash"> Cash</label>
<label><input type="checkbox" value="item_cash_pile"> Cash Pile</label>
<label><input type="checkbox" value="item_cash_mega_pile"> Cash Mega Pile</label>
<label><input type="checkbox" value="item_calculator"> Calculator</label>
<label><input type="checkbox" value="item_dvd"> DVD</label>
<label><input type="checkbox" value="item_floppy_disc_3"> Floppy Disc 3</label>
<label><input type="checkbox" value="item_floppy_disc_5"> Floppy Disc 5</label>
<label><input type="checkbox" value="item_keycard"> Keycard</label>
<label><input type="checkbox" value="item_mug"> Mug</label>
<label><input type="checkbox" value="item_cinder"> Cinder</label>
<label><input type="checkbox" value="item_paper"> Paper</label>
<label><input type="checkbox" value="item_mob_weapons_loot_box"> Mob Weapons Loot Box</label>
<label><input type="checkbox" value="item_scissors"> Scissors</label>
<label><input type="checkbox" value="item_stapler"> Stapler</label>
<label><input type="checkbox" value="item_tape_dispenser"> Tape Dispenser</label>
<label><input type="checkbox" value="item_time_bomb"> Time Bomb</label>
<label><input type="checkbox" value="item_cup"> Cup</label>
<label><input type="checkbox" value="item_golden_cup"> Golden Cup</label>
<label><input type="checkbox" value="item_sticker_bomb"> Sticker Bomb</label>
<label><input type="checkbox" value="item_crate"> Crate</label>
<label><input type="checkbox" value="item_egg"> Egg</label>
<label><input type="checkbox" value="item_red_flashlight"> Red Flashlight</label>
<label><input type="checkbox" value="item_gold_bar"> Gold Bar</label>
<label><input type="checkbox" value="item_heart_chunk"> Heart Chunk</label>
<label><input type="checkbox" value="item_haunted_house_key"> Haunted House Key</label>
<label><input type="checkbox" value="item_gold_revolver"> Gold Revolver</label>
<label><input type="checkbox" value="item_big_cup"> Big Cup</label>
<label><input type="checkbox" value="item_nut"> Nut</label>
<label><input type="checkbox" value="item_painting_canvas"> Painting Canvas</label>
<label><input type="checkbox" value="item_pelican_case"> Pelican Case (Suitcase)</label>
<label><input type="checkbox" value="item_pipe"> Pipe</label>
<label><input type="checkbox" value="item_pumpkin_jack"> Pumpkin Jack</label>
<label><input type="checkbox" value="item_small_pumpkin_jack"> Small Pumpkin Jack</label>
<label><input type="checkbox" value="item_big_mob_loot_box"> Big Mob Loot Box</label>
<label><input type="checkbox" value="item_mob_loot_box"> Mob Loot Box</label>
<label><input type="checkbox" value="item_small_mob_loot_box"> Small Mob Loot Box</label>
<label><input type="checkbox" value="item_scanner"> Scanner</label>
<label><input type="checkbox" value="item_toilet_paper"> Toilet Paper</label>
<label><input type="checkbox" value="item_mega_toilet_paper"> Mega Toilet Paper</label>
<label><input type="checkbox" value="item_empty_toilet_paper_roll"> Empty Toilet Paper Roll</label>
<label><input type="checkbox" value="item_trophy"> Trophy</label>
<label><input type="checkbox" value="item_unknown_item"> Unknown Item</label>
<label><input type="checkbox" value="item_upsidedown_loot"> Upsidedown Loot</label>
<label><input type="checkbox" value="item_large_uranium_chunk"> Large Uranium Chunk</label>
<label><input type="checkbox" value="item_uranium_chunk"> Uranium Chunk</label>
<label><input type="checkbox" value="item_small_uranium_chunk"> Small Uranium Chunk</label>
<label><input type="checkbox" value="item_ruby"> Ruby</label>
<label><input type="checkbox" value="item_large_silver_chunk"> Large Silver Chunk</label>
<label><input type="checkbox" value="item_silver_chunk"> Silver Chunk</label>
<label><input type="checkbox" value="item_small_silver_chunk"> Small Silver Chunk</label>
<label><input type="checkbox" value="item_large_copper_chunk"> Large Copper Chunk</label>
<label><input type="checkbox" value="item_copper_chunk"> Copper Chunk</label>
<label><input type="checkbox" value="item_small_copper_chunk"> Small Copper Chunk</label>
<label><input type="checkbox" value="item_large_gold_chunk"> Large Gold Chunk</label>
<label><input type="checkbox" value="item_gold_chunk"> Gold Chunk</label>
<label><input type="checkbox" value="item_small_gold_chunk"> Small Gold Chunk</label>
<label><input type="checkbox" value="item_arena_shotgun"> Arena Shotgun</label>
<label><input type="checkbox" value="item_arena_revolver"> Arena Revolver</label>
  </div>

  <div class="row" style="justify-content: space-between;">
    <button class="download-button" onclick="downloadJSON()">Download</button>
    <button onclick="randomStuff()">ðŸŽ²</button>
  </div>

  <div class="row" style="justify-content: space-between;">
    <button onclick="addRandomRayguns()">Add Random Items</button>
    <button onclick="undoJSON()">Undo</button>
    <button onclick="redoJSON()">Redo</button>
  </div>
</div>

<div class="preview" id="previewPanel">
  <h3 style="font-size: 22px;">Item Settings</h3>
</div>
<script>
const undoStack = [];
const redoStack = [];

function updateSlider(id) {
  document.getElementById(id + "Val").textContent = document.getElementById(id).value;
}

function filterItems() {
  const input = document.getElementById("searchInput").value.toLowerCase();
  document.querySelectorAll("#itemList label").forEach(label => {
    label.style.display = label.textContent.toLowerCase().includes(input) ? "block" : "none";
  });
}

function selectAllItems() {
  document.querySelectorAll('#itemList input[type=checkbox]').forEach(cb => cb.checked = true);
  generateTabs();
}

function deselectAllItems() {
  document.querySelectorAll('#itemList input[type=checkbox]').forEach(cb => cb.checked = false);
  generateTabs();
}

function randomStuff() {
  document.querySelectorAll('#itemList input[type=checkbox]').forEach(cb => cb.checked = Math.random() < 0.3);
  generateTabs();
}
document.addEventListener("change", function(e) {
  if (e.target.closest("#itemList")) {
    generateTabs();
  }
});

function generateTabs() {
  const preview = document.getElementById("previewPanel");
  preview.innerHTML = "<h3 style='font-size:22px;'>Item Settings</h3>";
  const selected = Array.from(document.querySelectorAll('#itemList input:checked')).map(cb => cb.value);

  selected.forEach(item => {
    const tab = document.createElement("div");
    tab.className = "tab";
    const name = item.replace("item_", "").replace(/_/g, " ");
    const hue = Math.floor(Math.random() * 241);
    const sat = Math.floor(Math.random() * 249) - 124;

    tab.innerHTML = `
      <h4>${name}</h4>
      <label>Hue</label>
      <input type="range" min="0" max="240" value="${hue}" class="hue">
      <label>Saturation</label>
      <input type="range" min="-124" max="124" value="${sat}" class="saturation">
      <label>Scale</label>
      <input type="range" min="-127" max="127" value="0" class="scale">
      <label>Count</label>
      <input type="number" min="1" max="500" value="1" class="count">
      <input type="hidden" value="${item}" class="itemID">
      <div class="colorPreview"></div>
    `;

    preview.appendChild(tab);
  });

  updateAllPreviews();
  document.querySelectorAll('.tab').forEach(tab => {
    ['hue', 'saturation'].forEach(cls => {
      tab.querySelector(`.${cls}`).addEventListener("input", () => updatePreview(tab));
    });
  });
}

function updateAllPreviews() {
  document.querySelectorAll(".tab").forEach(updatePreview);
}

function updatePreview(tab) {
  const hue = parseInt(tab.querySelector(".hue").value);
  const sat = parseInt(tab.querySelector(".saturation").value);
  const satPercent = Math.round(((sat + 124) / 248) * 100);
  const color = `hsl(${hue}, ${satPercent}%, 50%)`;
  tab.querySelector(".colorPreview").style.backgroundColor = color;
}
function chunkArray(array, size) {
  const chunks = [];
  for (let i = 0; i < array.length; i += size) {
    chunks.push(array.slice(i, i + size));
  }
  return chunks;
}

function getCurrentRayguns() {
  const tabs = document.querySelectorAll(".tab");
  const raygunCount = parseInt(document.getElementById("raygunCount").value);
  const raygunsWithItems = [];

  tabs.forEach(tab => {
    const itemID = tab.querySelector(".itemID").value;
    const hue = parseInt(tab.querySelector(".hue").value);
    const sat = parseInt(tab.querySelector(".saturation").value);
    const scale = parseInt(tab.querySelector(".scale").value);
    const count = parseInt(tab.querySelector(".count").value);

    for (let i = 0; i < count * raygunCount; i++) {
      raygunsWithItems.push({
        itemID: "item_heart_gun",
        children: [
          {
            itemID: itemID,
            colorHue: hue,
            colorSaturation: sat,
            scaleModifier: scale
          }
        ]
      });
    }
  });

  return raygunsWithItems;
}

function downloadJSON() {
  const filename = "custom_items";
  const backpackCount = parseInt(document.getElementById("backpackCount").value);
  const rayguns = getCurrentRayguns();
  const raygunChunks = chunkArray(rayguns, 24);

  const filledBackpacks = raygunChunks.map(chunk => ({
    itemID: "item_heart_gun",
    children: [
      {
        itemID: "item_backpack_large_base",
        children: chunk
      }
    ]
  }));

  const backpackChildren = filledBackpacks.slice(0, backpackCount);

  const output = {
    version: 1,
    items: [
      {
        itemID: "item_backpack_large_base",
        children: backpackChildren,
        stashPos: 0
      }
    ]
  };

  undoStack.push(JSON.stringify(output));
  redoStack.length = 0;

  const blob = new Blob([JSON.stringify(output, null, 4)], { type: "application/json" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = filename + ".json";
  link.click();
}
function undoJSON() {
  if (undoStack.length > 1) {
    const last = undoStack.pop();
    redoStack.push(last);
    alert("Undo performed.");
  } else {
    alert("Nothing to undo.");
  }
}

function redoJSON() {
  if (redoStack.length > 0) {
    const restored = redoStack.pop();
    undoStack.push(restored);
    alert("Redo performed.");
  } else {
    alert("Nothing to redo.");
  }
}

function addRandomRayguns() {
  const items = Array.from(document.querySelectorAll('#itemList input')).map(cb => cb.value);
  const preview = document.getElementById("previewPanel");

  const randomItem = () => items[Math.floor(Math.random() * items.length)];

  for (let i = 0; i < 5; i++) {
    const tab = document.createElement("div");
    tab.className = "tab";
    const item = randomItem();
    const hue = Math.floor(Math.random() * 241);
    const sat = Math.floor(Math.random() * 249) - 124;
    tab.innerHTML = `
      <h4>${item.replace("item_", "").replace(/_/g, " ")}</h4>
      <label>Hue</label>
      <input type="range" min="0" max="240" value="${hue}" class="hue">
      <label>Saturation</label>
      <input type="range" min="-124" max="124" value="${sat}" class="saturation">
      <label>Scale</label>
      <input type="range" min="-127" max="127" value="0" class="scale">
      <label>Count</label>
      <input type="number" min="1" max="500" value="1" class="count">
      <input type="hidden" value="${item}" class="itemID">
      <div class="colorPreview"></div>
    `;
    preview.appendChild(tab);
  }

  updateAllPreviews();
}
</script>
</body>
</html>
