<!DOCTYPE html>
<html>
<head>
  <title>Advanced JSON Generator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #1e1e1e;
      color: white;
      text-align: center;
      padding: 50px;
    }
    .container {
      background: #2e2e2e;
      padding: 40px;
      border-radius: 10px;
      display: inline-block;
    }
    select, input[type="range"], input[type="number"], input[type="text"] {
      margin-top: 10px;
      width: 100%;
      padding: 10px;
      border-radius: 5px;
    }
    label {
      display: block;
      margin-top: 20px;
      font-weight: bold;
    }
    .controls {
      display: flex;
      gap: 5px;
      align-items: center;
    }
    .button-small {
      padding: 6px 10px;
      font-size: 12px;
      width: auto;
    }
    #colorPreview {
      width: 100%;
      height: 40px;
      border-radius: 5px;
      margin-top: 10px;
      background: hsl(0, 0%, 50%);
    }
    .button-row {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }
    button {
      padding: 10px 20px;
      font-weight: bold;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Advanced JSON Generator</h1>

    <label for="item">Items (Ctrl/Cmd to select multiple)</label>
    <select id="item" multiple size="10"></select>

    <label for="hue">Hue (<span id="hueVal">0</span>)</label>
    <div class="controls">
      <input type="range" id="hue" min="0" max="240" value="0" oninput="updateValue('hue')">
      <button class="button-small" onclick="randomHue()">ðŸŽ¨ Random</button>
    </div>

    <label for="saturation">Saturation (<span id="saturationVal">0</span>)</label>
    <div class="controls">
      <input type="range" id="saturation" min="-124" max="124" value="0" oninput="updateValue('saturation')">
      <button class="button-small" onclick="randomSaturation()">ðŸŽ¨ Random</button>
    </div>

    <label for="scale">Size (<span id="scaleVal">0</span>)</label>
    <div class="controls">
      <input type="range" id="scale" min="-127" max="127" value="0" oninput="updateValue('scale')">
      <button class="button-small" onclick="randomScale()">ðŸŽ² Random</button>
    </div>

    <label for="count">Number of Backpacks</label>
    <input type="number" id="count" min="1" max="500" value="1">

    <label for="filename">Download As</label>
    <input type="text" id="filename" value="custom_items">

    <label>Color Preview</label>
    <div id="colorPreview"></div>

    <div class="button-row">
      <button onclick="downloadJSON()">Download JSON</button>
      <button onclick="randomStuff()" title="Randomize everything"
        style="width: 40px; height: 40px; padding: 0; font-size: 18px;">ðŸŽ²</button>
    </div>
  </div>

  <script>
    const items = [
      "Apple", "Pumpkin Pie", "Pelican Case (Suitcase)", "Time Bomb", "Gold Revolver",
      "Egg", "Nut Shredder", "Ruby", "Pizza", "Mega Broccoli"
    ];

    const select = document.getElementById("item");
    items.forEach(item => {
      const option = document.createElement("option");
      option.value = "item_" + item.toLowerCase().replace(/[^a-z0-9]/g, "_");
      option.text = item;
      select.appendChild(option);
    });

    function updateValue(id) {
      document.getElementById(id + 'Val').textContent = document.getElementById(id).value;
      updateColorPreview();
    }

    function updateColorPreview() {
      const hue = parseInt(document.getElementById("hue").value);
      const sat = parseInt(document.getElementById("saturation").value);
      const scaledSat = Math.round(((sat + 124) / 248) * 100);
      document.getElementById("colorPreview").style.backgroundColor = `hsl(${hue}, ${scaledSat}%, 50%)`;
    }

    function randomHue() {
      document.getElementById("hue").value = Math.floor(Math.random() * 241);
      updateValue("hue");
    }

    function randomSaturation() {
      document.getElementById("saturation").value = Math.floor(Math.random() * 249) - 124;
      updateValue("saturation");
    }

    function randomScale() {
      document.getElementById("scale").value = Math.floor(Math.random() * 255) - 127;
      updateValue("scale");
    }

    function randomStuff() {
      const options = document.querySelectorAll('#item option');
      options.forEach(opt => opt.selected = Math.random() < 0.4);
      randomHue(); randomSaturation(); randomScale();
    }

    function downloadJSON() {
      const selected = Array.from(document.getElementById("item").selectedOptions).map(o => o.value);
      const hue = parseInt(document.getElementById("hue").value);
      const saturation = parseInt(document.getElementById("saturation").value);
      const scale = parseInt(document.getElementById("scale").value);
      const count = Math.min(parseInt(document.getElementById("count").value), 500);
      const filename = document.getElementById("filename").value || "custom_items";

      const innerItems = selected.map(item => ({
        itemID: "item_heart_gun",
        children: [
          {
            itemID: item,
            colorHue: hue,
            colorSaturation: saturation,
            scaleModifier: scale
          }
        ]
      }));

      const raygunWithBackpack = {
        itemID: "item_heart_gun",
        children: [
          {
            itemID: "item_backpack_large_base",
            children: innerItems
          }
        ]
      };

      const outerStructure = {
        version: 1,
        items: [
          {
            itemID: "item_backpack_large_base",
            children: Array(count).fill(raygunWithBackpack),
            stashPos: 0
          }
        ]
      };

      const blob = new Blob([JSON.stringify(outerStructure, null, 4)], { type: "application/json" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = filename + ".json";
      link.click();
    }
  </script>
</body>
</html>
